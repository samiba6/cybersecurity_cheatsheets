Malware Analysis â€“ Concise Notes
1. Core Principles

Malware analysis = understanding how a malicious file works to defend against it.

Two analysis types:

Static analysis â†’ examine file without running it.

Dynamic analysis â†’ run malware in a safe environment to observe behaviour.

Always analyse malware in isolated sandboxes/VMs (snapshot-capable).

ğŸ”’ Sandboxes

Safe, isolated virtual environments for testing malicious code.

Allow reverting to clean state via snapshots.

Golden rule: Never run malware on a machine you care about.

ğŸ§ª Static Analysis

Goal: Gather quick insights without executing the malware.

Tools

PeStudio (used here)

Others: strings, VirusTotal, PEview

Common data collected
Item	Purpose
Checksums (SHA256)	Identify and track malicious samples.
Strings	Reveal IPs, URLs, commands, keywords, credentials, flags.
Imports	Show what Windows API functions the malware uses (e.g., file creation, networking).
Resources	Icons or embedded files; sometimes malware hides here.
PeStudio Workflow

Open PeStudio.

Load executable (HopHelper.exe).

Check Indicators â†’ SHA256.

Open Strings tab â†’ scan for suspicious text (URLs, IPs, commands, flags).

âš™ï¸ Dynamic Analysis

Goal: Observe real behaviour when the malware runs.

Tools

Regshot â†’ monitors registry changes (persistence).

ProcMon â†’ monitors all process activity (file, registry, network operations).

ğŸ”§ Regshot Workflow (Persistence detection)

Open Regshot.

Set output directory (Desktop).

Take 1st Shot (snapshot before execution).

Run malware (HopHelper.exe).

Take 2nd Shot.

Compare â†’ view registry changes.

Search for:

Run keys
HKCU/HKLM/.../CurrentVersion/Run

Added or modified keys indicating persistence.

ğŸ•µï¸ ProcMon Workflow (Behaviour monitoring)

Open ProcMon.

Run HopHelper.exe.

Wait 1 minuteâ†’ Stop capture.

Apply filter:

Process Name is HopHelper.exe

Further filters for operations:

RegOpenKey

CreateFile

TCP Connect

Look for:

File writes

Registry edits

Network communication (HTTP/HTTPS)

Command-and-control URLs/IPs

ğŸ—ï¸ Key Commands & Concepts
Common Windows API Imports

CreateFileW â†’ malware writing/creating files.

RegOpenKey â†’ registry access.

Network-related: WinHttpSendRequest, InternetOpenA, etc.

Persistence Mechanisms

Registry Run keys:

HKCU\...\CurrentVersion\Run

HKLM\...\CurrentVersion\Run

Networking Indicators

Look for:

TCP Connect

TCP Receive

URLs / domains in strings

HTTP/HTTPS usage in ProcMon
